<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Interactive Earth + Night Lights</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    html,body{margin:0;height:100%;background:#000;color:#eee;font-family:Arial,Helvetica,sans-serif;overflow:hidden}
    #info{position:absolute;top:12px;left:12px;font-size:13px;pointer-events:none;text-shadow:0 0 4px #000}
  </style>

  <!-- Import map for Skypack -->
  <script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.156.0/build/three.module.js",
    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.156.0/examples/jsm/"
  }
}
</script>
</head>
<body>
  <div id="info"><strong>Interactive Earth</strong><br>Drag to rotate • Scroll to zoom • Right-drag to pan</div>

  <script type="module">
    import * as THREE from "https://cdn.skypack.dev/three";
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    /* ---------- CONFIG ---------- */
    const ASSETS = {
      earthMap : 'https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg',
      bumpMap  : 'https://threejs.org/examples/textures/planets/earth_normal_2048.jpg',
      specMap  : 'https://threejs.org/examples/textures/planets/earth_specular_2048.jpg',
      nightMap : 'https://threejs.org/examples/textures/planets/earth_lights_2048.jpg',
      clouds   : 'https://threejs.org/examples/textures/planets/earth_clouds_1024.png',
      stars    : 'https://threejs.org/examples/textures/2k_stars.jpg'
    };

    /* ---------- BASIC SETUP ---------- */
    const scene    = new THREE.Scene();
    const camera   = new THREE.PerspectiveCamera(45, innerWidth / innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(innerWidth, innerHeight);
    renderer.setPixelRatio(devicePixelRatio);
    document.body.appendChild(renderer.domElement);

    /* ---------- LIGHTS ---------- */
    const sun = new THREE.DirectionalLight(0xffffff, 1.8);
    sun.position.set(5, 3, 5);
    scene.add(sun);
    scene.add(new THREE.AmbientLight(0x222244));

    /* ---------- STARFIELD ---------- */
    const loader = new THREE.TextureLoader();
    const starSphere = new THREE.Mesh(
      new THREE.SphereGeometry(500, 64, 64),
      new THREE.MeshBasicMaterial({ map: loader.load(ASSETS.stars), side: THREE.BackSide })
    );
    scene.add(starSphere);

    /* ---------- EARTH GROUP ---------- */
    const earthGroup = new THREE.Group();
    scene.add(earthGroup);

    /* Day-side earth */
    const earthMat = new THREE.MeshPhongMaterial({
      map:       loader.load(ASSETS.earthMap),
      bumpMap:   loader.load(ASSETS.bumpMap),
      bumpScale: 0.05,
      specularMap: loader.load(ASSETS.specMap),
      specular: new THREE.Color(0x666666)
    });
    const earthMesh = new THREE.Mesh(new THREE.SphereGeometry(2, 64, 64), earthMat);
    earthGroup.add(earthMesh);

    /* Night-side lights (emissive) */
    const nightMat = new THREE.MeshBasicMaterial({
      map: loader.load(ASSETS.nightMap),
      blending: THREE.AdditiveBlending,
      opacity: 1
    });
    const nightMesh = new THREE.Mesh(new THREE.SphereGeometry(2.001, 64, 64), nightMat);
    earthGroup.add(nightMesh);

    /* ---------- CLOUDS ---------- */
    const cloudMat = new THREE.MeshPhongMaterial({
      map: loader.load(ASSETS.clouds),
      transparent: true,
      opacity: 0.8,
      depthWrite: false
    });
    const cloudMesh = new THREE.Mesh(new THREE.SphereGeometry(2.02, 64, 64), cloudMat);
    earthGroup.add(cloudMesh);

    /* ---------- CAMERA & CONTROLS ---------- */
    camera.position.set(0, 0, 6);
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;
    controls.minDistance = 3;
    controls.maxDistance = 20;

    /* ---------- ANIMATION LOOP ---------- */
    const clock = new THREE.Clock();
    function animate() {
      requestAnimationFrame(animate);
      const t = clock.getElapsedTime();
      earthMesh.rotation.y = nightMesh.rotation.y = t * 0.05;
      cloudMesh.rotation.y = t * 0.07;
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    /* ---------- RESIZE ---------- */
    addEventListener('resize', () => {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
    });
  </script>
</body>
</html>
